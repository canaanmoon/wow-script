local Hunter = "target"
local HunterPet ="targetpet"
local Tbm = ambufflist()
local Tbt = ambufflist(Hunter)
local TblPet = ambufflist(HunterPet)

if UnitName("target")== "幻灵晶体"
	then
	amrun("/targetlastenemy")
	--print("切换目标:"..猎人)
	return;
end

--if  amzy()== 猎人 then


--幻灵爆发
if  amcd("幻灵晶体") >0 and amtotem("幻灵晶体")<=10 
	then
	if not amfind("寒冰新星",Tbt) then
	amrun("寒冰新星")
	return;
	end
			
	if not amfind("寒冰新星",Tbt) then
	mrun("寒冰新星")
	return;
	end
			
	return;
	end

-- 隐身时靠近猎人结界
if amfind("隐形术",Tbm) and amjl(Hunter)<15
	then
	amrun ("寒冰结界")
	return;
end

--卡掉黑鸦buff出隐身一套控制爆发
if  not amfind ("隐形术","夺命黑鸦",Tbm)
	then
	
	-- 放晶体准备爆发
	if amfind("冰冻术",Tbt)-- and 主人的召唤cd
		then
		FHCastAOE(Hunter,"幻灵晶体")
		return;
	end
	
	----靠近猎人时使用结界冻8秒，然后远离15码卡宝宝距离骗主人的召唤，后冰冻
	if not amfind("冰冻术",Tbt)
		and not amfind("主人的召唤",Tbt)
		and amnewspelltime(Hunter,"主人的召唤")>0
		and FHObjectDistance(Hunter,HunterPet)>15 --and amjl(HunterPet)>15
		then
		amrun(冰冻术)
		return;
	end
	
	--寒冰结界逼出主人的召唤
	if not amfind("寒冰结界",Tbt) or amaura("寒冰结界", Hunter,0,2)<1.5
		then
		amrun("深度冻结")
		--print("需要晕的目标:"..UnitName("target"))
		return;
	end
	
	
	
	return;
end

--隐身术卡黑鸦
if amfind("夺命黑鸦",Tbm) and amcd("隐形术") <=0 and not amfind("隐形术",Tbm)
	then
	
	if  amfind("深度冻结", Tbt) and amfind("寒冰结界,冰锥术",TblPet)
		or  not amfind("深度冻结", Tbl) and amcd("深度冻结") >0 and amcd("闪现术") >0 and amcd("炽热疾速") >0 and amfind("寒冰新星", Tbt) and and amjl(Hunter)> 40
		then
		amrun("隐形术")
		return;
	end
	
	if not amfind("深度冻结", Tbt) and amcd("深度冻结") >0 and  not FHgetFacing(Hunter,120) and amcd("闪现术") >0 and amjl(Hunter)< 40
		then
		amrun("炽热疾速")
		return;
	end
	
	if not amfind("深度冻结", Tbt) and amcd("深度冻结") >0  and not FHgetFacing(Hunter,120) and  amjl(Hunter)< 40
		then
		amrun("闪现术")
		return;
	end
	
	if not amfind("深度冻结", Tbt) and amcd("深度冻结") >0  and not amfind("寒冰新星",Tbt)
		then
		amrun("寒冰新星")
		return;
	end
	
	if amfind("深度冻结", Tbt) and not amfind("寒冰结界",TblPet) and  amjl(HunterPet)<12
		then
		amrun("冰锥术")
		return;
	end
	
	if not amfind("冰冻术",Tbt) and amcd("冰冻术") <=0
		then
		FHCastAOE(Hunter,"冰冻术")
		--print("需要冰的目标:"..UnitName("target"))
		return;
	end
	
	if not amfind("深度冻结",Tbt)  and amcd("深度冻结") <=0
		then
		amrun("深度冻结")
		--print("需要晕的目标:"..UnitName("target"))
		return;
	end
	
	return;
end


--正常输出循环（晶体没有了以后）

--return;
--end
